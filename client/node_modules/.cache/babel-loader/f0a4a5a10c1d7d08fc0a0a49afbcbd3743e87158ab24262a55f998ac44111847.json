{"ast":null,"code":"import React,{createContext,useState,useEffect,useContext,useCallback}from'react';import axios from'../axiosConfig';import{AuthContext}from'./AuthContext';import{jsx as _jsx}from\"react/jsx-runtime\";const BookClubsContext=/*#__PURE__*/createContext();const BookClubsProvider=_ref=>{let{children}=_ref;const[bookClubs,setBookClubs]=useState([]);const{user}=useContext(AuthContext);useEffect(()=>{const fetchBookClubs=async()=>{if(user){try{const response=await axios.get('/book-clubs',{headers:{Authorization:`Bearer ${localStorage.getItem('token')}`}});setBookClubs(response.data);}catch(error){console.error('Error fetching book clubs:',error);}}};fetchBookClubs();},[user]);const updateBookClub=updatedClub=>{if(updatedClub.deleted){console.log(\"Deleting club with id:\",updatedClub.id);setBookClubs(prevClubs=>prevClubs.filter(club=>club.id!==updatedClub.id));}else{setBookClubs(prevClubs=>prevClubs.map(club=>club.id===updatedClub.id?updatedClub:club));}};const fetchClubDetails=useCallback(async id=>{try{const response=await axios.get(`/book-clubs/${id}`,{headers:{Authorization:`Bearer ${localStorage.getItem('token')}`}});return response.data;}catch(error){console.error('Error fetching club details.');return null;}},[]);const joinClub=useCallback(async id=>{try{const response=await axios.post(`/book-clubs/${id}`,{},{headers:{Authorization:`Bearer ${localStorage.getItem('token')}`}});return response.data;}catch(error){console.error('Error joining club.');return null;}},[]);const leaveClub=useCallback(async id=>{try{const response=await axios.delete(`/book-clubs/${id}`,{headers:{Authorization:`Bearer ${localStorage.getItem('token')}`}});return response.data;}catch(error){console.error('Error leaving club.');return null;}},[]);const createClub=useCallback(async newClub=>{try{const response=await axios.post('/book-clubs',newClub,{headers:{Authorization:`Bearer ${localStorage.getItem('token')}`}});setBookClubs(prevClubs=>[...prevClubs,response.data.club]);return response.data;}catch(error){console.error('Error creating book club.');throw error;}},[]);const fetchManageClubDetails=useCallback(async clubId=>{try{const response=await axios.get(`/manage-club/${clubId}`,{headers:{Authorization:`Bearer ${localStorage.getItem('token')}`}});return response.data;}catch(error){console.error('Error fetching manage club details.');return null;}},[]);const updateCurrentReading=useCallback(async(clubId,bookId)=>{try{const response=await axios.patch(`/manage-club/${clubId}`,{action:'update_current_reading',book_id:bookId},{headers:{Authorization:`Bearer ${localStorage.getItem('token')}`}});return response.data;}catch(error){console.error('Error updating current reading.');throw error;}},[]);const removeMember=useCallback(async(clubId,memberId)=>{try{const response=await axios.patch(`/manage-club/${clubId}`,{action:'remove_member',member_id:memberId},{headers:{Authorization:`Bearer ${localStorage.getItem('token')}`}});return response.data;}catch(error){console.error('Error removing member.');throw error;}},[]);const updateGenres=useCallback(async(clubId,genreIds)=>{try{const response=await axios.patch(`/manage-club/${clubId}`,{action:'update_genres',genre_ids:genreIds},{headers:{Authorization:`Bearer ${localStorage.getItem('token')}`}});return response.data;}catch(error){console.error('Error updating genres.');throw error;}},[]);const deleteClub=useCallback(async clubId=>{try{const response=await axios.delete(`/manage-club/${clubId}`,{headers:{Authorization:`Bearer ${localStorage.getItem('token')}`}});return response.data;}catch(error){console.error('Error deleting club.');throw error;}},[]);const fetchUserClubs=useCallback(async()=>{try{const response=await axios.get('/my-clubs',{headers:{Authorization:`Bearer ${localStorage.getItem('token')}`}});return response.data;}catch(error){console.error('Error fetching user clubs.');throw error;}},[]);return/*#__PURE__*/_jsx(BookClubsContext.Provider,{value:{bookClubs,setBookClubs,updateBookClub,fetchClubDetails,joinClub,leaveClub,createClub,fetchManageClubDetails,updateCurrentReading,removeMember,updateGenres,deleteClub,fetchUserClubs},children:children});};export{BookClubsContext,BookClubsProvider};","map":{"version":3,"names":["React","createContext","useState","useEffect","useContext","useCallback","axios","AuthContext","jsx","_jsx","BookClubsContext","BookClubsProvider","_ref","children","bookClubs","setBookClubs","user","fetchBookClubs","response","get","headers","Authorization","localStorage","getItem","data","error","console","updateBookClub","updatedClub","deleted","log","id","prevClubs","filter","club","map","fetchClubDetails","joinClub","post","leaveClub","delete","createClub","newClub","fetchManageClubDetails","clubId","updateCurrentReading","bookId","patch","action","book_id","removeMember","memberId","member_id","updateGenres","genreIds","genre_ids","deleteClub","fetchUserClubs","Provider","value"],"sources":["/home/levi/Development/book-club/client/src/components/context/BookClubsContext.js"],"sourcesContent":["import React, { createContext, useState, useEffect, useContext, useCallback } from 'react';\nimport axios from '../axiosConfig';\nimport { AuthContext } from './AuthContext';\n\nconst BookClubsContext = createContext();\n\nconst BookClubsProvider = ({ children }) => {\n  const [bookClubs, setBookClubs] = useState([]);\n  const { user } = useContext(AuthContext);\n\n  useEffect(() => {\n    const fetchBookClubs = async () => {\n      if (user) {\n        try {\n          const response = await axios.get('/book-clubs', {\n            headers: {\n              Authorization: `Bearer ${localStorage.getItem('token')}`,\n            },\n          });\n          setBookClubs(response.data);\n        } catch (error) {\n          console.error('Error fetching book clubs:', error);\n        }\n      }\n    };\n\n    fetchBookClubs();\n  }, [user]);\n\n  const updateBookClub = (updatedClub) => {\n    if (updatedClub.deleted) {\n      console.log(\"Deleting club with id:\", updatedClub.id);\n      setBookClubs((prevClubs) => prevClubs.filter(club => club.id !== updatedClub.id));\n    } else {\n      setBookClubs((prevClubs) => prevClubs.map(club => club.id === updatedClub.id ? updatedClub : club));\n    }\n  };\n\n  const fetchClubDetails = useCallback(async (id) => {\n    try {\n      const response = await axios.get(`/book-clubs/${id}`, {\n        headers: {\n          Authorization: `Bearer ${localStorage.getItem('token')}`,\n        },\n      });\n      return response.data;\n    } catch (error) {\n      console.error('Error fetching club details.');\n      return null;\n    }\n  }, []);\n\n  const joinClub = useCallback(async (id) => {\n    try {\n      const response = await axios.post(`/book-clubs/${id}`, {}, {\n        headers: {\n          Authorization: `Bearer ${localStorage.getItem('token')}`,\n        },\n      });\n      return response.data;\n    } catch (error) {\n      console.error('Error joining club.');\n      return null;\n    }\n  }, []);\n\n  const leaveClub = useCallback(async (id) => {\n    try {\n      const response = await axios.delete(`/book-clubs/${id}`, {\n        headers: {\n          Authorization: `Bearer ${localStorage.getItem('token')}`,\n        },\n      });\n      return response.data;\n    } catch (error) {\n      console.error('Error leaving club.');\n      return null;\n    }\n  }, []);\n\n  const createClub = useCallback(async (newClub) => {\n    try {\n      const response = await axios.post('/book-clubs', newClub, {\n        headers: {\n          Authorization: `Bearer ${localStorage.getItem('token')}`,\n        },\n      });\n      setBookClubs((prevClubs) => [...prevClubs, response.data.club]);\n      return response.data;\n    } catch (error) {\n      console.error('Error creating book club.');\n      throw error;\n    }\n  }, []);\n\n  const fetchManageClubDetails = useCallback(async (clubId) => {\n    try {\n      const response = await axios.get(`/manage-club/${clubId}`, {\n        headers: {\n          Authorization: `Bearer ${localStorage.getItem('token')}`,\n        },\n      });\n      return response.data;\n    } catch (error) {\n      console.error('Error fetching manage club details.');\n      return null;\n    }\n  }, []);\n\n  const updateCurrentReading = useCallback(async (clubId, bookId) => {\n    try {\n      const response = await axios.patch(`/manage-club/${clubId}`, {\n        action: 'update_current_reading',\n        book_id: bookId,\n      }, {\n        headers: {\n          Authorization: `Bearer ${localStorage.getItem('token')}`,\n        },\n      });\n      return response.data;\n    } catch (error) {\n      console.error('Error updating current reading.');\n      throw error;\n    }\n  }, []);\n\n  const removeMember = useCallback(async (clubId, memberId) => {\n    try {\n      const response = await axios.patch(`/manage-club/${clubId}`, {\n        action: 'remove_member',\n        member_id: memberId,\n      }, {\n        headers: {\n          Authorization: `Bearer ${localStorage.getItem('token')}`,\n        },\n      });\n      return response.data;\n    } catch (error) {\n      console.error('Error removing member.');\n      throw error;\n    }\n  }, []);\n\n  const updateGenres = useCallback(async (clubId, genreIds) => {\n    try {\n      const response = await axios.patch(`/manage-club/${clubId}`, {\n        action: 'update_genres',\n        genre_ids: genreIds,\n      }, {\n        headers: {\n          Authorization: `Bearer ${localStorage.getItem('token')}`,\n        },\n      });\n      return response.data;\n    } catch (error) {\n      console.error('Error updating genres.');\n      throw error;\n    }\n  }, []);\n\n  const deleteClub = useCallback(async (clubId) => {\n    try {\n      const response = await axios.delete(`/manage-club/${clubId}`, {\n        headers: {\n          Authorization: `Bearer ${localStorage.getItem('token')}`,\n        },\n      });\n      return response.data;\n    } catch (error) {\n      console.error('Error deleting club.');\n      throw error;\n    }\n  }, []);\n\n  const fetchUserClubs = useCallback(async () => {\n    try {\n      const response = await axios.get('/my-clubs', {\n        headers: {\n          Authorization: `Bearer ${localStorage.getItem('token')}`,\n        },\n      });\n      return response.data;\n    } catch (error) {\n      console.error('Error fetching user clubs.');\n      throw error;\n    }\n  }, []);\n  \n\n  return (\n    <BookClubsContext.Provider value={{\n      bookClubs,\n      setBookClubs,\n      updateBookClub,\n      fetchClubDetails,\n      joinClub,\n      leaveClub,\n      createClub,\n      fetchManageClubDetails,\n      updateCurrentReading,\n      removeMember,\n      updateGenres,\n      deleteClub,\n      fetchUserClubs\n    }}>\n      {children}\n    </BookClubsContext.Provider>\n  );\n};\n\nexport { BookClubsContext, BookClubsProvider };\n"],"mappings":"AAAA,MAAO,CAAAA,KAAK,EAAIC,aAAa,CAAEC,QAAQ,CAAEC,SAAS,CAAEC,UAAU,CAAEC,WAAW,KAAQ,OAAO,CAC1F,MAAO,CAAAC,KAAK,KAAM,gBAAgB,CAClC,OAASC,WAAW,KAAQ,eAAe,CAAC,OAAAC,GAAA,IAAAC,IAAA,yBAE5C,KAAM,CAAAC,gBAAgB,cAAGT,aAAa,CAAC,CAAC,CAExC,KAAM,CAAAU,iBAAiB,CAAGC,IAAA,EAAkB,IAAjB,CAAEC,QAAS,CAAC,CAAAD,IAAA,CACrC,KAAM,CAACE,SAAS,CAAEC,YAAY,CAAC,CAAGb,QAAQ,CAAC,EAAE,CAAC,CAC9C,KAAM,CAAEc,IAAK,CAAC,CAAGZ,UAAU,CAACG,WAAW,CAAC,CAExCJ,SAAS,CAAC,IAAM,CACd,KAAM,CAAAc,cAAc,CAAG,KAAAA,CAAA,GAAY,CACjC,GAAID,IAAI,CAAE,CACR,GAAI,CACF,KAAM,CAAAE,QAAQ,CAAG,KAAM,CAAAZ,KAAK,CAACa,GAAG,CAAC,aAAa,CAAE,CAC9CC,OAAO,CAAE,CACPC,aAAa,CAAE,UAAUC,YAAY,CAACC,OAAO,CAAC,OAAO,CAAC,EACxD,CACF,CAAC,CAAC,CACFR,YAAY,CAACG,QAAQ,CAACM,IAAI,CAAC,CAC7B,CAAE,MAAOC,KAAK,CAAE,CACdC,OAAO,CAACD,KAAK,CAAC,4BAA4B,CAAEA,KAAK,CAAC,CACpD,CACF,CACF,CAAC,CAEDR,cAAc,CAAC,CAAC,CAClB,CAAC,CAAE,CAACD,IAAI,CAAC,CAAC,CAEV,KAAM,CAAAW,cAAc,CAAIC,WAAW,EAAK,CACtC,GAAIA,WAAW,CAACC,OAAO,CAAE,CACvBH,OAAO,CAACI,GAAG,CAAC,wBAAwB,CAAEF,WAAW,CAACG,EAAE,CAAC,CACrDhB,YAAY,CAAEiB,SAAS,EAAKA,SAAS,CAACC,MAAM,CAACC,IAAI,EAAIA,IAAI,CAACH,EAAE,GAAKH,WAAW,CAACG,EAAE,CAAC,CAAC,CACnF,CAAC,IAAM,CACLhB,YAAY,CAAEiB,SAAS,EAAKA,SAAS,CAACG,GAAG,CAACD,IAAI,EAAIA,IAAI,CAACH,EAAE,GAAKH,WAAW,CAACG,EAAE,CAAGH,WAAW,CAAGM,IAAI,CAAC,CAAC,CACrG,CACF,CAAC,CAED,KAAM,CAAAE,gBAAgB,CAAG/B,WAAW,CAAC,KAAO,CAAA0B,EAAE,EAAK,CACjD,GAAI,CACF,KAAM,CAAAb,QAAQ,CAAG,KAAM,CAAAZ,KAAK,CAACa,GAAG,CAAC,eAAeY,EAAE,EAAE,CAAE,CACpDX,OAAO,CAAE,CACPC,aAAa,CAAE,UAAUC,YAAY,CAACC,OAAO,CAAC,OAAO,CAAC,EACxD,CACF,CAAC,CAAC,CACF,MAAO,CAAAL,QAAQ,CAACM,IAAI,CACtB,CAAE,MAAOC,KAAK,CAAE,CACdC,OAAO,CAACD,KAAK,CAAC,8BAA8B,CAAC,CAC7C,MAAO,KAAI,CACb,CACF,CAAC,CAAE,EAAE,CAAC,CAEN,KAAM,CAAAY,QAAQ,CAAGhC,WAAW,CAAC,KAAO,CAAA0B,EAAE,EAAK,CACzC,GAAI,CACF,KAAM,CAAAb,QAAQ,CAAG,KAAM,CAAAZ,KAAK,CAACgC,IAAI,CAAC,eAAeP,EAAE,EAAE,CAAE,CAAC,CAAC,CAAE,CACzDX,OAAO,CAAE,CACPC,aAAa,CAAE,UAAUC,YAAY,CAACC,OAAO,CAAC,OAAO,CAAC,EACxD,CACF,CAAC,CAAC,CACF,MAAO,CAAAL,QAAQ,CAACM,IAAI,CACtB,CAAE,MAAOC,KAAK,CAAE,CACdC,OAAO,CAACD,KAAK,CAAC,qBAAqB,CAAC,CACpC,MAAO,KAAI,CACb,CACF,CAAC,CAAE,EAAE,CAAC,CAEN,KAAM,CAAAc,SAAS,CAAGlC,WAAW,CAAC,KAAO,CAAA0B,EAAE,EAAK,CAC1C,GAAI,CACF,KAAM,CAAAb,QAAQ,CAAG,KAAM,CAAAZ,KAAK,CAACkC,MAAM,CAAC,eAAeT,EAAE,EAAE,CAAE,CACvDX,OAAO,CAAE,CACPC,aAAa,CAAE,UAAUC,YAAY,CAACC,OAAO,CAAC,OAAO,CAAC,EACxD,CACF,CAAC,CAAC,CACF,MAAO,CAAAL,QAAQ,CAACM,IAAI,CACtB,CAAE,MAAOC,KAAK,CAAE,CACdC,OAAO,CAACD,KAAK,CAAC,qBAAqB,CAAC,CACpC,MAAO,KAAI,CACb,CACF,CAAC,CAAE,EAAE,CAAC,CAEN,KAAM,CAAAgB,UAAU,CAAGpC,WAAW,CAAC,KAAO,CAAAqC,OAAO,EAAK,CAChD,GAAI,CACF,KAAM,CAAAxB,QAAQ,CAAG,KAAM,CAAAZ,KAAK,CAACgC,IAAI,CAAC,aAAa,CAAEI,OAAO,CAAE,CACxDtB,OAAO,CAAE,CACPC,aAAa,CAAE,UAAUC,YAAY,CAACC,OAAO,CAAC,OAAO,CAAC,EACxD,CACF,CAAC,CAAC,CACFR,YAAY,CAAEiB,SAAS,EAAK,CAAC,GAAGA,SAAS,CAAEd,QAAQ,CAACM,IAAI,CAACU,IAAI,CAAC,CAAC,CAC/D,MAAO,CAAAhB,QAAQ,CAACM,IAAI,CACtB,CAAE,MAAOC,KAAK,CAAE,CACdC,OAAO,CAACD,KAAK,CAAC,2BAA2B,CAAC,CAC1C,KAAM,CAAAA,KAAK,CACb,CACF,CAAC,CAAE,EAAE,CAAC,CAEN,KAAM,CAAAkB,sBAAsB,CAAGtC,WAAW,CAAC,KAAO,CAAAuC,MAAM,EAAK,CAC3D,GAAI,CACF,KAAM,CAAA1B,QAAQ,CAAG,KAAM,CAAAZ,KAAK,CAACa,GAAG,CAAC,gBAAgByB,MAAM,EAAE,CAAE,CACzDxB,OAAO,CAAE,CACPC,aAAa,CAAE,UAAUC,YAAY,CAACC,OAAO,CAAC,OAAO,CAAC,EACxD,CACF,CAAC,CAAC,CACF,MAAO,CAAAL,QAAQ,CAACM,IAAI,CACtB,CAAE,MAAOC,KAAK,CAAE,CACdC,OAAO,CAACD,KAAK,CAAC,qCAAqC,CAAC,CACpD,MAAO,KAAI,CACb,CACF,CAAC,CAAE,EAAE,CAAC,CAEN,KAAM,CAAAoB,oBAAoB,CAAGxC,WAAW,CAAC,MAAOuC,MAAM,CAAEE,MAAM,GAAK,CACjE,GAAI,CACF,KAAM,CAAA5B,QAAQ,CAAG,KAAM,CAAAZ,KAAK,CAACyC,KAAK,CAAC,gBAAgBH,MAAM,EAAE,CAAE,CAC3DI,MAAM,CAAE,wBAAwB,CAChCC,OAAO,CAAEH,MACX,CAAC,CAAE,CACD1B,OAAO,CAAE,CACPC,aAAa,CAAE,UAAUC,YAAY,CAACC,OAAO,CAAC,OAAO,CAAC,EACxD,CACF,CAAC,CAAC,CACF,MAAO,CAAAL,QAAQ,CAACM,IAAI,CACtB,CAAE,MAAOC,KAAK,CAAE,CACdC,OAAO,CAACD,KAAK,CAAC,iCAAiC,CAAC,CAChD,KAAM,CAAAA,KAAK,CACb,CACF,CAAC,CAAE,EAAE,CAAC,CAEN,KAAM,CAAAyB,YAAY,CAAG7C,WAAW,CAAC,MAAOuC,MAAM,CAAEO,QAAQ,GAAK,CAC3D,GAAI,CACF,KAAM,CAAAjC,QAAQ,CAAG,KAAM,CAAAZ,KAAK,CAACyC,KAAK,CAAC,gBAAgBH,MAAM,EAAE,CAAE,CAC3DI,MAAM,CAAE,eAAe,CACvBI,SAAS,CAAED,QACb,CAAC,CAAE,CACD/B,OAAO,CAAE,CACPC,aAAa,CAAE,UAAUC,YAAY,CAACC,OAAO,CAAC,OAAO,CAAC,EACxD,CACF,CAAC,CAAC,CACF,MAAO,CAAAL,QAAQ,CAACM,IAAI,CACtB,CAAE,MAAOC,KAAK,CAAE,CACdC,OAAO,CAACD,KAAK,CAAC,wBAAwB,CAAC,CACvC,KAAM,CAAAA,KAAK,CACb,CACF,CAAC,CAAE,EAAE,CAAC,CAEN,KAAM,CAAA4B,YAAY,CAAGhD,WAAW,CAAC,MAAOuC,MAAM,CAAEU,QAAQ,GAAK,CAC3D,GAAI,CACF,KAAM,CAAApC,QAAQ,CAAG,KAAM,CAAAZ,KAAK,CAACyC,KAAK,CAAC,gBAAgBH,MAAM,EAAE,CAAE,CAC3DI,MAAM,CAAE,eAAe,CACvBO,SAAS,CAAED,QACb,CAAC,CAAE,CACDlC,OAAO,CAAE,CACPC,aAAa,CAAE,UAAUC,YAAY,CAACC,OAAO,CAAC,OAAO,CAAC,EACxD,CACF,CAAC,CAAC,CACF,MAAO,CAAAL,QAAQ,CAACM,IAAI,CACtB,CAAE,MAAOC,KAAK,CAAE,CACdC,OAAO,CAACD,KAAK,CAAC,wBAAwB,CAAC,CACvC,KAAM,CAAAA,KAAK,CACb,CACF,CAAC,CAAE,EAAE,CAAC,CAEN,KAAM,CAAA+B,UAAU,CAAGnD,WAAW,CAAC,KAAO,CAAAuC,MAAM,EAAK,CAC/C,GAAI,CACF,KAAM,CAAA1B,QAAQ,CAAG,KAAM,CAAAZ,KAAK,CAACkC,MAAM,CAAC,gBAAgBI,MAAM,EAAE,CAAE,CAC5DxB,OAAO,CAAE,CACPC,aAAa,CAAE,UAAUC,YAAY,CAACC,OAAO,CAAC,OAAO,CAAC,EACxD,CACF,CAAC,CAAC,CACF,MAAO,CAAAL,QAAQ,CAACM,IAAI,CACtB,CAAE,MAAOC,KAAK,CAAE,CACdC,OAAO,CAACD,KAAK,CAAC,sBAAsB,CAAC,CACrC,KAAM,CAAAA,KAAK,CACb,CACF,CAAC,CAAE,EAAE,CAAC,CAEN,KAAM,CAAAgC,cAAc,CAAGpD,WAAW,CAAC,SAAY,CAC7C,GAAI,CACF,KAAM,CAAAa,QAAQ,CAAG,KAAM,CAAAZ,KAAK,CAACa,GAAG,CAAC,WAAW,CAAE,CAC5CC,OAAO,CAAE,CACPC,aAAa,CAAE,UAAUC,YAAY,CAACC,OAAO,CAAC,OAAO,CAAC,EACxD,CACF,CAAC,CAAC,CACF,MAAO,CAAAL,QAAQ,CAACM,IAAI,CACtB,CAAE,MAAOC,KAAK,CAAE,CACdC,OAAO,CAACD,KAAK,CAAC,4BAA4B,CAAC,CAC3C,KAAM,CAAAA,KAAK,CACb,CACF,CAAC,CAAE,EAAE,CAAC,CAGN,mBACEhB,IAAA,CAACC,gBAAgB,CAACgD,QAAQ,EAACC,KAAK,CAAE,CAChC7C,SAAS,CACTC,YAAY,CACZY,cAAc,CACdS,gBAAgB,CAChBC,QAAQ,CACRE,SAAS,CACTE,UAAU,CACVE,sBAAsB,CACtBE,oBAAoB,CACpBK,YAAY,CACZG,YAAY,CACZG,UAAU,CACVC,cACF,CAAE,CAAA5C,QAAA,CACCA,QAAQ,CACgB,CAAC,CAEhC,CAAC,CAED,OAASH,gBAAgB,CAAEC,iBAAiB","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}