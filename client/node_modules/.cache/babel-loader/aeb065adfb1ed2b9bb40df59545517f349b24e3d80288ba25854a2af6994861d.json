{"ast":null,"code":"import React,{useEffect,useState,useContext}from'react';import{Layout,Spin,Card,Button,Rate}from'antd';import{Link}from'react-router-dom';import axios from'./axiosConfig';import NavBar from'./NavBar';import{ThemeContext}from'./context/ThemeContext';import'./css/MyBookList.css';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const{Content}=Layout;const MyBookList=()=>{const{theme}=useContext(ThemeContext);const[bookList,setBookList]=useState([]);const[loading,setLoading]=useState(true);const[error,setError]=useState('');useEffect(()=>{const fetchBookList=async()=>{try{const response=await axios.get('/user/books',{headers:{Authorization:`Bearer ${localStorage.getItem('token')}`}});setBookList(response.data);setLoading(false);}catch(error){setError('Error fetching book list.');setLoading(false);}};fetchBookList();},[]);const handleStarClick=async(nextValue,bookId)=>{try{await axios.patch(`/user/books/${bookId}`,{rating:nextValue},{headers:{Authorization:`Bearer ${localStorage.getItem('token')}`}});setBookList(prevList=>prevList.map(book=>book.id===bookId?{...book,rating:nextValue}:book));}catch(error){console.error('Error updating rating:',error);}};const handleRemoveBook=async bookId=>{try{await axios.delete(`/user/books/${bookId}`,{headers:{Authorization:`Bearer ${localStorage.getItem('token')}`}});setBookList(prevList=>prevList.filter(book=>book.id!==bookId));}catch(error){console.error('Error removing book from list:',error);}};return/*#__PURE__*/_jsxs(Layout,{className:`my-book-list-page ${theme}`,children:[/*#__PURE__*/_jsx(NavBar,{}),/*#__PURE__*/_jsx(Content,{style:{padding:'0 48px'},children:/*#__PURE__*/_jsx(Layout,{style:{padding:'24px 0',background:'var(--background-color)'},children:/*#__PURE__*/_jsx(Content,{style:{padding:'0 24px',minHeight:280},children:/*#__PURE__*/_jsxs(\"div\",{className:\"main-content\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"My Book List\"}),loading?/*#__PURE__*/_jsx(Spin,{size:\"large\"}):bookList.length===0?/*#__PURE__*/_jsx(\"div\",{className:\"empty-list-message\",children:/*#__PURE__*/_jsxs(\"p\",{children:[\"Your book list is currently empty. To add some books, go to \",/*#__PURE__*/_jsx(Link,{to:\"/books\",children:\"Library\"}),\".\"]})}):/*#__PURE__*/_jsx(\"div\",{className:\"books-container\",children:bookList.map(book=>/*#__PURE__*/_jsxs(Card,{hoverable:true,cover:/*#__PURE__*/_jsx(\"img\",{alt:book.title,src:book.image_url,className:\"book-image\"}),className:`book-card ${theme}`,actions:[/*#__PURE__*/_jsx(Button,{type:\"primary\",onClick:()=>handleRemoveBook(book.id),children:\"Remove from List\"})],children:[/*#__PURE__*/_jsx(Card.Meta,{title:book.title,description:`Author: ${book.author}`}),/*#__PURE__*/_jsxs(\"div\",{className:\"rating\",children:[/*#__PURE__*/_jsx(\"h4\",{children:\"Rating:\"}),/*#__PURE__*/_jsx(Rate,{value:book.rating||0,onChange:nextValue=>handleStarClick(nextValue,book.id)})]})]},book.id))}),error&&/*#__PURE__*/_jsx(\"p\",{className:\"error-message\",children:error})]})})})})]});};export default MyBookList;","map":{"version":3,"names":["React","useEffect","useState","useContext","Layout","Spin","Card","Button","Rate","Link","axios","NavBar","ThemeContext","jsx","_jsx","jsxs","_jsxs","Content","MyBookList","theme","bookList","setBookList","loading","setLoading","error","setError","fetchBookList","response","get","headers","Authorization","localStorage","getItem","data","handleStarClick","nextValue","bookId","patch","rating","prevList","map","book","id","console","handleRemoveBook","delete","filter","className","children","style","padding","background","minHeight","size","length","to","hoverable","cover","alt","title","src","image_url","actions","type","onClick","Meta","description","author","value","onChange"],"sources":["/home/levi/Development/book-club/client/src/components/MyBookList.js"],"sourcesContent":["import React, { useEffect, useState, useContext } from 'react';\nimport { Layout, Spin, Card, Button, Rate } from 'antd';\nimport { Link } from 'react-router-dom';\nimport axios from './axiosConfig';\nimport NavBar from './NavBar';\nimport { ThemeContext } from './context/ThemeContext';\nimport './css/MyBookList.css';\n\nconst { Content } = Layout;\n\nconst MyBookList = () => {\n  const { theme } = useContext(ThemeContext);\n  const [bookList, setBookList] = useState([]);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState('');\n\n  useEffect(() => {\n    const fetchBookList = async () => {\n      try {\n        const response = await axios.get('/user/books', {\n          headers: {\n            Authorization: `Bearer ${localStorage.getItem('token')}`,\n          },\n        });\n        setBookList(response.data);\n        setLoading(false);\n      } catch (error) {\n        setError('Error fetching book list.');\n        setLoading(false);\n      }\n    };\n\n    fetchBookList();\n  }, []);\n\n  const handleStarClick = async (nextValue, bookId) => {\n    try {\n      await axios.patch(\n        `/user/books/${bookId}`,\n        { rating: nextValue },\n        {\n          headers: {\n            Authorization: `Bearer ${localStorage.getItem('token')}`,\n          },\n        }\n      );\n      setBookList((prevList) =>\n        prevList.map((book) =>\n          book.id === bookId ? { ...book, rating: nextValue } : book\n        )\n      );\n    } catch (error) {\n      console.error('Error updating rating:', error);\n    }\n  };\n\n  const handleRemoveBook = async (bookId) => {\n    try {\n      await axios.delete(`/user/books/${bookId}`, {\n        headers: {\n          Authorization: `Bearer ${localStorage.getItem('token')}`,\n        },\n      });\n      setBookList((prevList) => prevList.filter((book) => book.id !== bookId));\n    } catch (error) {\n      console.error('Error removing book from list:', error);\n    }\n  };\n\n  return (\n    <Layout className={`my-book-list-page ${theme}`}>\n      <NavBar />\n      <Content\n        style={{\n          padding: '0 48px',\n        }}\n      >\n        <Layout\n          style={{\n            padding: '24px 0',\n            background: 'var(--background-color)', \n          }}\n        >\n          <Content\n            style={{\n              padding: '0 24px',\n              minHeight: 280,\n            }}\n          >\n            <div className=\"main-content\">\n              <h2>My Book List</h2>\n              {loading ? (\n                <Spin size=\"large\" />\n              ) : bookList.length === 0 ? (\n                <div className=\"empty-list-message\">\n                  <p>Your book list is currently empty. To add some books, go to <Link to=\"/books\">Library</Link>.</p>\n                </div>\n              ) : (\n                <div className=\"books-container\">\n                  {bookList.map((book) => (\n                    <Card\n                      key={book.id}\n                      hoverable\n                      cover={<img alt={book.title} src={book.image_url} className=\"book-image\" />}\n                      className={`book-card ${theme}`} \n                      actions={[\n                        <Button type=\"primary\" onClick={() => handleRemoveBook(book.id)}>Remove from List</Button>,\n                      ]}\n                    >\n                      <Card.Meta title={book.title} description={`Author: ${book.author}`} />\n                      <div className=\"rating\">\n                        <h4>Rating:</h4>\n                        <Rate\n                          value={book.rating || 0}\n                          onChange={(nextValue) => handleStarClick(nextValue, book.id)}\n                        />\n                      </div>\n                    </Card>\n                  ))}\n                </div>\n              )}\n              {error && <p className=\"error-message\">{error}</p>}\n            </div>\n          </Content>\n        </Layout>\n      </Content>\n    </Layout>\n  );\n}\n\nexport default MyBookList;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}