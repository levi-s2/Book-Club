{"ast":null,"code":"var _jsxFileName = \"/home/levi/Development/book-club/client/src/components/context/PostsContext.js\",\n  _s = $RefreshSig$();\nimport React, { createContext, useState, useCallback } from 'react';\nimport axios from '../axiosConfig';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst PostsContext = /*#__PURE__*/createContext();\nconst PostsProvider = ({\n  children\n}) => {\n  _s();\n  const [posts, setPosts] = useState([]);\n  const [userVotes, setUserVotes] = useState({});\n  const fetchPostsAndVotes = useCallback(async clubId => {\n    try {\n      const response = await axios.get(`/book-clubs/${clubId}`, {\n        headers: {\n          Authorization: `Bearer ${localStorage.getItem('token')}`\n        }\n      });\n      setPosts(response.data.posts || []);\n      const votes = response.data.posts.reduce((acc, post) => {\n        acc[post.id] = post.user_voted;\n        return acc;\n      }, {});\n      setUserVotes(votes);\n    } catch (error) {\n      console.error('Error fetching posts and votes:', error);\n    }\n  }, []);\n  const addPost = useCallback(async (clubId, content) => {\n    try {\n      const response = await axios.post(`/book-clubs/${clubId}/posts`, {\n        content\n      }, {\n        headers: {\n          Authorization: `Bearer ${localStorage.getItem('token')}`\n        }\n      });\n      setPosts(prevState => [...(prevState || []), response.data]);\n    } catch (error) {\n      console.error('Error adding post:', error);\n      throw error;\n    }\n  }, []);\n  const editPost = useCallback(async (postId, content) => {\n    try {\n      const response = await axios.patch(`/posts/${postId}`, {\n        content\n      }, {\n        headers: {\n          Authorization: `Bearer ${localStorage.getItem('token')}`\n        }\n      });\n      setPosts(prevState => (prevState || []).map(post => post.id === postId ? response.data : post));\n    } catch (error) {\n      console.error('Error editing post:', error);\n      throw error;\n    }\n  }, []);\n  const deletePost = useCallback(async postId => {\n    try {\n      await axios.delete(`/posts/${postId}`, {\n        headers: {\n          Authorization: `Bearer ${localStorage.getItem('token')}`\n        }\n      });\n      setPosts(prevState => (prevState || []).filter(post => post.id !== postId));\n    } catch (error) {\n      console.error('Error deleting post:', error);\n      throw error;\n    }\n  }, []);\n  const votePost = useCallback(async (postId, vote) => {\n    try {\n      const response = await axios.post(`/posts/${postId}/vote`, {\n        vote\n      }, {\n        headers: {\n          Authorization: `Bearer ${localStorage.getItem('token')}`\n        }\n      });\n      setPosts(prevState => (prevState || []).map(post => post.id === postId ? response.data : post));\n      setUserVotes(prev => ({\n        ...prev,\n        [postId]: prev[postId] === vote ? null : vote\n      }));\n    } catch (error) {\n      console.error('Error voting on post:', error);\n      throw error;\n    }\n  }, []);\n  return /*#__PURE__*/_jsxDEV(PostsContext.Provider, {\n    value: {\n      posts,\n      userVotes,\n      fetchPostsAndVotes,\n      addPost,\n      editPost,\n      deletePost,\n      votePost\n    },\n    children: children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 94,\n    columnNumber: 5\n  }, this);\n};\n_s(PostsProvider, \"nPkTrkWxoq+DO918s92NEmjPypA=\");\n_c = PostsProvider;\nexport { PostsProvider, PostsContext };\nvar _c;\n$RefreshReg$(_c, \"PostsProvider\");","map":{"version":3,"names":["React","createContext","useState","useCallback","axios","jsxDEV","_jsxDEV","PostsContext","PostsProvider","children","_s","posts","setPosts","userVotes","setUserVotes","fetchPostsAndVotes","clubId","response","get","headers","Authorization","localStorage","getItem","data","votes","reduce","acc","post","id","user_voted","error","console","addPost","content","prevState","editPost","postId","patch","map","deletePost","delete","filter","votePost","vote","prev","Provider","value","fileName","_jsxFileName","lineNumber","columnNumber","_c","$RefreshReg$"],"sources":["/home/levi/Development/book-club/client/src/components/context/PostsContext.js"],"sourcesContent":["import React, { createContext, useState, useCallback } from 'react';\nimport axios from '../axiosConfig';\n\n\nconst PostsContext = createContext();\n\nconst PostsProvider = ({ children }) => {\n\n  const [posts, setPosts] = useState([]);\n  const [userVotes, setUserVotes] = useState({});\n\n  const fetchPostsAndVotes = useCallback(async (clubId) => {\n    try {\n      const response = await axios.get(`/book-clubs/${clubId}`, {\n        headers: {\n          Authorization: `Bearer ${localStorage.getItem('token')}`,\n        },\n      });\n      setPosts(response.data.posts || []);\n\n      const votes = response.data.posts.reduce((acc, post) => {\n        acc[post.id] = post.user_voted;\n        return acc;\n      }, {});\n\n      setUserVotes(votes);\n    } catch (error) {\n      console.error('Error fetching posts and votes:', error);\n    }\n  }, []);\n\n  const addPost = useCallback(async (clubId, content) => {\n    try {\n      const response = await axios.post(`/book-clubs/${clubId}/posts`, { content }, {\n        headers: {\n          Authorization: `Bearer ${localStorage.getItem('token')}`,\n        },\n      });\n      setPosts((prevState) => [...(prevState || []), response.data]);\n    } catch (error) {\n      console.error('Error adding post:', error);\n      throw error;\n    }\n  }, []);\n\n  const editPost = useCallback(async (postId, content) => {\n    try {\n      const response = await axios.patch(`/posts/${postId}`, { content }, {\n        headers: {\n          Authorization: `Bearer ${localStorage.getItem('token')}`,\n        },\n      });\n      setPosts((prevState) =>\n        (prevState || []).map((post) => (post.id === postId ? response.data : post))\n      );\n    } catch (error) {\n      console.error('Error editing post:', error);\n      throw error;\n    }\n  }, []);\n\n  const deletePost = useCallback(async (postId) => {\n    try {\n      await axios.delete(`/posts/${postId}`, {\n        headers: {\n          Authorization: `Bearer ${localStorage.getItem('token')}`,\n        },\n      });\n      setPosts((prevState) => (prevState || []).filter((post) => post.id !== postId));\n    } catch (error) {\n      console.error('Error deleting post:', error);\n      throw error;\n    }\n  }, []);\n\n  const votePost = useCallback(async (postId, vote) => {\n    try {\n      const response = await axios.post(`/posts/${postId}/vote`, { vote }, {\n        headers: {\n          Authorization: `Bearer ${localStorage.getItem('token')}`,\n        },\n      });\n      setPosts((prevState) =>\n        (prevState || []).map((post) => (post.id === postId ? response.data : post))\n      );\n      setUserVotes((prev) => ({ ...prev, [postId]: prev[postId] === vote ? null : vote }));\n    } catch (error) {\n      console.error('Error voting on post:', error);\n      throw error;\n    }\n  }, []);\n\n  return (\n    <PostsContext.Provider value={{ posts, userVotes, fetchPostsAndVotes, addPost, editPost, deletePost, votePost }}>\n      {children}\n    </PostsContext.Provider>\n  );\n};\n\nexport { PostsProvider, PostsContext };\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}