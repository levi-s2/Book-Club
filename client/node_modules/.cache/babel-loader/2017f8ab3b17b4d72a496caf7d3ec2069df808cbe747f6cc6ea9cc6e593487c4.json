{"ast":null,"code":"import React,{useState,useContext,useEffect}from'react';import{AuthContext}from'./context/AuthContext';import{PostsContext}from'./context/PostsContext';import{List,Form,Input,Button,Typography,Space,message}from'antd';import{LikeTwoTone,DislikeTwoTone}from'@ant-design/icons';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const{TextArea}=Input;const Posts=_ref=>{let{clubId}=_ref;const{user}=useContext(AuthContext);const{posts,userVotes,fetchPostsAndVotes,addPost,editPost,deletePost,votePost}=useContext(PostsContext);const[form]=Form.useForm();const[newPostContent,setNewPostContent]=useState('');const[editingPost,setEditingPost]=useState(null);const[editedContent,setEditedContent]=useState('');const[error,setError]=useState('');useEffect(()=>{if(user){fetchPostsAndVotes(clubId);}},[user,clubId,fetchPostsAndVotes]);const handleAddPost=async values=>{if(!values.content){setError('Post content cannot be empty.');return;}try{await addPost(clubId,values.content);form.resetFields();message.success('Post added successfully');}catch(error){setError('Error adding post.');}};const handleEditPost=async postId=>{if(!editedContent){setError('Edited content cannot be empty.');return;}try{await editPost(postId,editedContent);setEditingPost(null);setEditedContent('');message.success('Post edited successfully');}catch(error){setError('Error editing post.');}};const handleDeletePost=async postId=>{try{await deletePost(postId);message.success('Post deleted successfully');}catch(error){setError('Error deleting post.');}};const handleVotePost=async(postId,vote)=>{try{await votePost(postId,vote);}catch(error){setError('Error voting on post.');}};return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"new-post\",children:[/*#__PURE__*/_jsx(\"h4\",{children:\"Add a Post\"}),/*#__PURE__*/_jsxs(Form,{form:form,onFinish:handleAddPost,children:[/*#__PURE__*/_jsx(Form.Item,{name:\"content\",children:/*#__PURE__*/_jsx(TextArea,{value:newPostContent,onChange:e=>setNewPostContent(e.target.value),placeholder:\"Write your post here...\",rows:4})}),/*#__PURE__*/_jsx(Form.Item,{children:/*#__PURE__*/_jsx(Button,{type:\"primary\",htmlType:\"submit\",children:\"Post\"})}),error&&/*#__PURE__*/_jsx(Typography.Text,{type:\"danger\",className:\"error-message\",children:error})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"club-posts\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Posts\"}),posts&&posts.length>0?/*#__PURE__*/_jsx(List,{itemLayout:\"vertical\",size:\"large\",dataSource:posts,renderItem:post=>/*#__PURE__*/_jsxs(List.Item,{actions:[/*#__PURE__*/_jsxs(Space,{children:[/*#__PURE__*/_jsx(LikeTwoTone,{onClick:()=>handleVotePost(post.id,1),twoToneColor:userVotes[post.id]===1?\"#52c41a\":undefined}),/*#__PURE__*/_jsx(DislikeTwoTone,{onClick:()=>handleVotePost(post.id,-1),twoToneColor:userVotes[post.id]===-1?\"#eb2f96\":undefined}),user&&user.id===post.user_id&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(Button,{type:\"link\",style:{padding:'0'},onClick:()=>{setEditingPost(post.id);setEditedContent(post.content);},children:\"Edit\"}),/*#__PURE__*/_jsx(Button,{type:\"link\",style:{padding:'0'},onClick:()=>handleDeletePost(post.id),children:\"Delete\"})]})]})],children:[/*#__PURE__*/_jsx(List.Item.Meta,{title:`By: ${post.username}`,description:`Votes: ${post.votes}`}),editingPost===post.id?/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(TextArea,{value:editedContent,onChange:e=>setEditedContent(e.target.value),rows:4}),/*#__PURE__*/_jsx(Button,{onClick:()=>handleEditPost(post.id),children:\"Save\"})]}):/*#__PURE__*/_jsx(Typography.Paragraph,{children:post.content})]},post.id)}):/*#__PURE__*/_jsx(\"p\",{children:\"No posts yet.\"})]})]});};export default Posts;","map":{"version":3,"names":["React","useState","useContext","useEffect","AuthContext","PostsContext","List","Form","Input","Button","Typography","Space","message","LikeTwoTone","DislikeTwoTone","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","TextArea","Posts","_ref","clubId","user","posts","userVotes","fetchPostsAndVotes","addPost","editPost","deletePost","votePost","form","useForm","newPostContent","setNewPostContent","editingPost","setEditingPost","editedContent","setEditedContent","error","setError","handleAddPost","values","content","resetFields","success","handleEditPost","postId","handleDeletePost","handleVotePost","vote","children","className","onFinish","Item","name","value","onChange","e","target","placeholder","rows","type","htmlType","Text","length","itemLayout","size","dataSource","renderItem","post","actions","onClick","id","twoToneColor","undefined","user_id","style","padding","Meta","title","username","description","votes","Paragraph"],"sources":["/home/levi/Development/book-club/client/src/components/Posts.js"],"sourcesContent":["import React, { useState, useContext, useEffect } from 'react';\nimport { AuthContext } from './context/AuthContext';\nimport { PostsContext } from './context/PostsContext';\nimport { List, Form, Input, Button, Typography, Space, message } from 'antd';\nimport { LikeTwoTone, DislikeTwoTone } from '@ant-design/icons';\n\nconst { TextArea } = Input;\n\nconst Posts = ({ clubId }) => {\n  const { user } = useContext(AuthContext);\n  const { posts, userVotes, fetchPostsAndVotes, addPost, editPost, deletePost, votePost } = useContext(PostsContext);\n  const [form] = Form.useForm();\n  const [newPostContent, setNewPostContent] = useState('');\n  const [editingPost, setEditingPost] = useState(null);\n  const [editedContent, setEditedContent] = useState('');\n  const [error, setError] = useState('');\n\n  useEffect(() => {\n    if (user) {\n      fetchPostsAndVotes(clubId);\n    }\n  }, [user, clubId, fetchPostsAndVotes]);\n\n  const handleAddPost = async (values) => {\n    if (!values.content) {\n      setError('Post content cannot be empty.');\n      return;\n    }\n\n    try {\n      await addPost(clubId, values.content);\n      form.resetFields();\n      message.success('Post added successfully');\n    } catch (error) {\n      setError('Error adding post.');\n    }\n  };\n\n  const handleEditPost = async (postId) => {\n    if (!editedContent) {\n      setError('Edited content cannot be empty.');\n      return;\n    }\n\n    try {\n      await editPost(postId, editedContent);\n      setEditingPost(null);\n      setEditedContent('');\n      message.success('Post edited successfully');\n    } catch (error) {\n      setError('Error editing post.');\n    }\n  };\n\n  const handleDeletePost = async (postId) => {\n    try {\n      await deletePost(postId);\n      message.success('Post deleted successfully');\n    } catch (error) {\n      setError('Error deleting post.');\n    }\n  };\n\n  const handleVotePost = async (postId, vote) => {\n    try {\n      await votePost(postId, vote);\n    } catch (error) {\n      setError('Error voting on post.');\n    }\n  };\n\n  return (\n    <div>\n      <div className=\"new-post\">\n        <h4>Add a Post</h4>\n        <Form form={form} onFinish={handleAddPost}>\n          <Form.Item name=\"content\">\n            <TextArea\n              value={newPostContent}\n              onChange={(e) => setNewPostContent(e.target.value)}\n              placeholder=\"Write your post here...\"\n              rows={4}\n            />\n          </Form.Item>\n          <Form.Item>\n            <Button type=\"primary\" htmlType=\"submit\">\n              Post\n            </Button>\n          </Form.Item>\n          {error && <Typography.Text type=\"danger\" className=\"error-message\">{error}</Typography.Text>}\n        </Form>\n      </div>\n      <div className=\"club-posts\">\n        <h3>Posts</h3>\n        {posts && posts.length > 0 ? (\n          <List\n            itemLayout=\"vertical\"\n            size=\"large\"\n            dataSource={posts}\n            renderItem={(post) => (\n              <List.Item\n                key={post.id}\n                actions={[\n                  <Space>\n                    <LikeTwoTone\n                      onClick={() => handleVotePost(post.id, 1)}\n                      twoToneColor={userVotes[post.id] === 1 ? \"#52c41a\" : undefined}\n                    />\n                    <DislikeTwoTone\n                      onClick={() => handleVotePost(post.id, -1)}\n                      twoToneColor={userVotes[post.id] === -1 ? \"#eb2f96\" : undefined}\n                    />\n                    {user && user.id === post.user_id && (\n                      <>\n                        <Button\n                          type=\"link\"\n                          style={{ padding: '0' }}\n                          onClick={() => {\n                            setEditingPost(post.id);\n                            setEditedContent(post.content);\n                          }}\n                        >\n                          Edit\n                        </Button>\n                        <Button\n                          type=\"link\"\n                          style={{ padding: '0' }}\n                          onClick={() => handleDeletePost(post.id)}\n                        >\n                          Delete\n                        </Button>\n                      </>\n                    )}\n                  </Space>,\n                ]}\n              >\n                <List.Item.Meta\n                  title={`By: ${post.username}`}\n                  description={`Votes: ${post.votes}`}\n                />\n                {editingPost === post.id ? (\n                  <div>\n                    <TextArea\n                      value={editedContent}\n                      onChange={(e) => setEditedContent(e.target.value)}\n                      rows={4}\n                    />\n                    <Button onClick={() => handleEditPost(post.id)}>Save</Button>\n                  </div>\n                ) : (\n                  <Typography.Paragraph>{post.content}</Typography.Paragraph>\n                )}\n              </List.Item>\n            )}\n          />\n        ) : (\n          <p>No posts yet.</p>\n        )}\n      </div>\n    </div>\n  );\n};\n\nexport default Posts;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}